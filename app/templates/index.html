<head>
<link rel="stylesheet" href={{ url_for('static', filename='style.css') }}>
</head>
<body>

<div class="container">
<button id="add_bar" onClick="progress_bar()">Add Progress</button>
</div>

<script src="/static/nanobar.min.js"></script>
<script>

var nanobars = [];

function add_bar() {
	// Create div to put new bar in
	var div = document.createElement("div");
	div.setAttribute("id", "bar-" + nanobars.length);
	document.body.appendChild(div);

	// Create paragraph for progress text
	var p = document.createElement("p");
	p.setAttribute("id", "p-" + nanobars.length);
	p.setAttribute("style", "margin-top: 0;");
	document.getElementById("bar-" + nanobars.length).appendChild(p);
	var ptext = document.createTextNode(0);
	p.appendChild(ptext);

	// Create new bar, push to array
	var bar = new Nanobar({
		target: document.getElementById("bar-" + nanobars.length),
		class: "bar",
		id: "nanobar-" + nanobars.length
	});
	nanobars.push(bar);
	bar.go(0);
}

function progress_bar() {

	// Add initial bar
	if (nanobars.length === 0) {
		add_bar();
	}

	// Go through bars, update progress
	var i;
	for (i = 0; i < nanobars.length; i++) {
		var progress = Number(document.getElementById("bar-" + i).lastChild.textContent.replace("%", ""));
		
		progress = progress + 20;
		nanobars[i].go(progress);
		
		if (progress === 100) {
			document.getElementById("p-" + i).innerHTML = "Done!";
			document.getElementById("nanobar-" + i).firstChild.style.background = "lime";
			add_bar();
		} else if (progress < 100) {
			document.getElementById("p-" + i).innerHTML = progress + "%";
		}
	}
}
</script>
	
</body>
</html>
